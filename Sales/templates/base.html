<!DOCTYPE html>
<html lang="en">
{% load static %}

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Customer Data</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto%7CVarela+Round">
  <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.3.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.3.1/firebase-database.js"></script>
  <script src="../../../static/js/demo.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>

  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">



  <!-- pagination -->
  <link rel="stylesheet" type="text/css" href="{% static 'customer.css' %}">
  <script src="https://code.jquery.com/jquery-3.7.0.js"></script>
  


  <!-- navbar link -->

  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Bootstrap 5 Side Bar Navigation</title>
  <!-- bootstrap 5 css -->
  <!-- BOX ICONS CSS-->
  <link href="https://cdn.jsdelivr.net/npm/boxicons@2.0.5/css/boxicons.min.css" rel="stylesheet" />
  <!-- custom css -->
  <link rel="stylesheet" href="style.css" />
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta2/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-b5kHyXgcpbZJO/tY9Ul7kGkf1S0CWuKcCD38l8YkeH8z8QjE0GmW1gYU5S9FOnJ0"
    crossorigin="anonymous"></script>
    




    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto%7CVarela+Round">
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.3.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.3.1/firebase-database.js"></script>
    <script src="../../../static/js/demo.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>

    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

    <script src="https://code.jquery.com/jquery-3.7.0.js"></script>
    <link rel="stylesheet" href="style.css" />
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta2/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-b5kHyXgcpbZJO/tY9Ul7kGkf1S0CWuKcCD38l8YkeH8z8QjE0GmW1gYU5S9FOnJ0"
      crossorigin="anonymous"></script>

          <link rel="apple-touch-icon" href="{% static 'appassets/images/ico/apple-icon-120.png' %}">

    <link rel="shortcut icon" type="image/x-icon" href="{% static 'appassets/images/logo/favicon.ico' %}">

    <link href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,300;0,400;0,500;0,600;1,400;1,500;1,600" rel="stylesheet">


    <!-- data table library -->

    

    
<style>
body{

background-color: #eee; 
}

table th , table td{
text-align: center;
}

table tr:nth-child(even){
background-color: #e4e3e3
}

th {
background: #637285;
color: #fff;
}

.pagination {
margin: 0;

}

.pagination li:hover{
cursor: pointer;
}

.header_wrap {
padding:30px 0;
}
.num_rows {
width: 20%;
float:left;
}
.tb_search{
width: 20%;
float:right;
}
.pagination-container {
width: 70%;
float:left;

}

.rows_count {
width: 20%;
float:right;
text-align:right;
color: #999;
}


</style>

  <style>
    a {
      color: black;
    }

   
 </style>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      min-height: 100vh;
      background-color: #fff;
    }

    .side-navbar {
      width: 180px;
      height: 100%;
      position: fixed;
      margin-left: -300px;
      background-color: #021c3c;
      transition: 0.5s;
      color: #fff;
      font-size: 10px;
    }

    .nav-link:active,
    .nav-link:focus,
    .nav-link:hover {
      background-color: #10def024;
      color: #fff;
    }

    .my-container {
      transition: 0.4s;
    }

    .active-nav {
      margin-left: 0;
    }

    /* For main section */
    .active-cont {
      margin-left: 180px;
    }

    #menu-btn {
      background-color: #021c3c;
      color: white;
    }

    .my-container input {
      border-radius: 2rem;
      padding: 2px 20px;
    }

    /* Media Queries for different views */

    /* For mobile phones (portrait and landscape) */
    @media only screen and (max-width: 767px) {

      /* Add your CSS styles specific to mobile phones here */
      /* For example, you can change font sizes or padding */
      body {
        font-size: 14px;
        /* Adjust the font size for better readability on mobile */
      }

      .side-navbar {
        font-size: 8px;
        /* Adjust the font size of the side navbar for mobile */
      }

      /* You can add more styles specific to mobile view here */
    }

    /* For tablets (portrait and landscape) */
    @media only screen and (min-width: 768px) and (max-width: 991px) {
      /* Add your CSS styles specific to tablets here */
      /* For example, you can adjust the size or position of elements */
    }

    /* For laptops and larger screens */
    @media only screen and (min-width: 992px) {
      /* Add your CSS styles specific to laptops and larger screens here */
      /* For example, you can modify the layout or margins */
    }



    /* Your other styles for the popup container and content */

    /* Media query for tablets and larger */
    @media screen and (min-width: 768px) {
      .modal-content {
        width: 600px;
        /* Adjust the width as needed for tablets */
        margin: 0 auto;
        /* Center the modal horizontally */
      }
    }

    /* Media query for mobile phones */
    @media screen and (max-width: 767px) {
      .modal-content {
        width: 90%;
        /* Make the modal almost full width on small screens */
        margin: 30px auto;
        /* Add some margin for better spacing */
      }

      .modal-body {
        display: flex;
        flex-wrap: wrap;
        /* Allow the form elements to wrap to a new line */
        justify-content: center;
        /* Center the form elements within the modal */
      }

      .modal-body>div {
        width: 100%;
        /* Make each form section full width on mobile */
      }

      /* Adjust individual form elements as needed for mobile view */
      .form-group {
        width: 100%;
      }

      /* Add any other mobile-specific styling here */
    }
    .card {
  box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2); /* this adds the "card" effect */
  padding: 16px;
  text-align: center;
  background-color: #f1f1f1;
}
  </style>


</head>

<body>

  <!-- Side-Nav -->
  <div class="side-navbar active-nav d-flex justify-content-between flex-wrap flex-column" id="sidebar">
    <img src="{% static 'Images/olatech_logo.jpg' %}" style="height: 40px; max-width:175px; margin-top: 20px;">
    <ul class="nav flex-column text-white w-100"><br><br><br><br>

      <a href="{% url 'customer_list' %}" class="nav-link h3 text-white my-2" style="font-size: 21px;">


        <li class="nav-link">
          <i class="bx bx-home-circle"></i>
          <span class="mx-2">Sales Lead</span>
        </li>
      </a><br>
      <a href="{% url 'branch_list' %}" class="nav-link h3 text-white my-2" style="font-size: 21px;">


        <li class="nav-link">
          <i class="bx bxs-dashboard"></i>
          <span class="mx-2">Branch</span>
        </li>
      </a><br>
      <a href="{% url 'manager_list' %}" class="nav-link h3 text-white my-2" style="font-size: 21px;">


        <li class="nav-link">
          <i class="bx bx-user-check"></i>
          <span class="mx-2">Manager</span>
        </li>
      </a><br>
     
      <!-- <a href="{% url 'map_executives'%}" class="nav-link h3 text-white my-2">


        <li class="nav-link">
          <i class="bx bx-user-check"></i>
          <span class="mx-2">Map Executive</span>
        </li>
      </a><br> -->
      <a href="{% url 'executive_list' %}" class="nav-link h3 text-white my-2" style="font-size: 21px;">


        <li class="nav-link">
          <i class="bx bx-conversation"></i>
          <span class="mx-2">Executive</span>
        </li>
      </a><br>
      <a href="{% url 'staff'%}" class="nav-link h3 text-white my-2" style="font-size: 21px;">


        <li class="nav-link">
          <i class="bx bxs-user-circle"></i>
          <span class="mx-2">Staff</span>
        </li>
      </a><br>
      <a href="{% url 'user_list' %}" class="nav-link h3 text-white my-2" style="font-size: 21px;">


        <li class="nav-link">
          <i class="bx bxs-user"></i>
          <span class="mx-2">Users</span>
        </li>
      </a><br>
      <a href="{% url 'role_display' %}" class="nav-link h3 text-white my-2" style="font-size: 22px;">


        <li class="nav-link">
          <i class="bx bx-notepad"></i>
          <span class="mx-2">Role</span>
        </li>
      </a>
      <br>

  </div>

  <!-- Main Wrapper -->
  <div class="my-container active-cont">
    <!-- Top Nav -->
    <nav class="navbar top-navbar navbar-light bg-light px-5">

      <a class="btn border-0" id="menu-btn"><i class="bx bx-menu"></i></a>
    </nav>


    <!-- Table Content Start -->
    <div class="text-right" style="margin-bottom: 10px;"> 

      <button type="button" class="btn btn-secondary" data-bs-toggle="dropdown"
        aria-expanded="false" >
        Hello, {{ request.session.username }}
      </button>
      <a href="#addCustomerModal" class="btn btn-success" data-toggle="modal"><i class="material-icons" ></i>
        <span  style="text-align: right ; margin-right: 5px; margin-bottom: 10px;">Add <i class="fa fa-plus"></i> </span></a>
      <!-- <a href="#addCustomerModal" class="btn btn-success" data-toggle="modal"><i class="material-icons"></i>
<span>Add </span></a> -->
      <!-- <button type="submit" id="delete_btn" class="btn btn-danger">Delete</button> -->
      <a href="{% url 'logout' %}" class="btn btn-primary" data-toggle="modal"><i class="material-icons"></i>
        <span>Logout</span></a><br><br>

    </div>
   

    
    <div class="card">
    <div class="search-bar" style="margin-right: 760px;">
      <label for="start_date">Start Date:</label>

      <input type="date" id="startDate" placeholder="Start Date">
      <label for="start_date">End Date:</label>

      <input type="date" id="endDate" placeholder="End Date">
    </div>
    
    <div class="table-responsive">     
      <div class="header_wrap">
        <div class="num_rows">
          
                <div class="form-group"><b>show </b> 	
                    <select  name="state" id="maxRows">
                         
                         
                         <option value="10">10</option>
                         <option value="20">20</option>
                         <option value="50">50</option>
                         <option value="100">100</option>
                         <option value="5000">Show ALL Rows</option>
                    </select>
                     <b>entries</b>
                </div>

        </div>

        <div class="tb_search">

           <input type="text" id="search_input_all" onkeyup="FilterkeyWord_all_table()" placeholder="Search.." class="form-control"><br>
        </div>
      </div>
      <table class="table table-striped table-class" id= "table" >

      <thead>
        <tr style="background-color:rgb(169, 192, 222);color:rgb(18, 16, 16);">
    
          <th>ID</th>
          <th>Branch Name</th>
          <th>Manager Name</th>
          <th>Executive Name</th>
          <th>Company Name</th>
          <th>Type of Client</th>
          <th>Client Status</th>
          <th>Client Name</th>
          <th>Contact No</th>
          <th>Address</th>

          <!-- <th>Mail ID</th> -->
          <!-- <th>Nature of Business</th> -->
          <th>Updation Date</th>
          <th>Meeting Date</th>
          <!-- <th>Status of Client</th> -->
          <th>Next Meeting Date</th>
          <!-- <th>Package Sold</th> -->
          <th>Contract Value</th>
          <th>Advance</th>
          <th>Balance Payment</th>
          <th>Activation Date</th>
          <th>Renewal Date</th>
          <!-- <th>Action</th> -->

        </tr>
      </thead>
      <tbody>
        {% for customer in page_obj %}
        <tr id="{{customer.id}}" class="student-item">
          <!-- <td>
        <input type="checkbox" name="change_id[]" id="delete_product" value="{{customer.id}}">

    </td> -->
          <td><a style="color: black;" href="{% url 'customer_detail' customer.id %}">{{ customer.id}}</a></td>
          <td><a style="color: black;" href="{% url 'customer_detail' customer.id %}">{{ customer.branch_list }}</a>
          </td>
          <td><a style="color: black;" href="{% url 'customer_detail' customer.id %}">{{ customer.manager_name }}</a>
          </td>
          <td><a style="color: black;" href="{% url 'customer_detail' customer.id %}">{{ customer.ex_name }}</a></td>

          <td><a style="color: black;" href="{% url 'customer_detail' customer.id %}">{{ customer.company_name }}</a>
          </td>
          <td><a style="color: black;" href="{% url 'customer_detail' customer.id %}">{{ customer.type_of_client }}</a>
          </td>
          <td><a style="color: black;" href="{% url 'customer_detail' customer.id %}">{{ customer.subpoints }}</a></td>
          <td><a style="color: black;" href="{% url 'customer_detail' customer.id %}">{{ customer.name }}</a></td>
          <td><a style="color: black;" href="{% url 'customer_detail' customer.id %}">{{ customer.contact_detail }}</a>
          </td>
          <td><a style="color: black;" href="{% url 'customer_detail' customer.id %}">{{ customer.address }}</a>
            
          </td>   
          <td><a style="color: black;" href="{% url 'customer_detail' customer.id %}">{{ customer.updation_date|date:"Y-m-d H:i:s" }}</a></td>
         
      
          
          <td><a style="color: black;" href="{% url 'customer_detail' customer.id %}">{{ customer.meeting_date }}</a>
          </td>
          <!-- <td><a style="color: black;" href="{% url 'customer_detail' customer.id %}">{{ customer.status_of_client }}</a></td> -->
          <td><a style="color: black;" href="{% url 'customer_detail' customer.id %}">{{ customer.next_meeting_date}}</a></td>
          <!-- <td><a style="color: black;" href="{% url 'customer_detail' customer.id %}">{{ customer.package_sold }}</a></td> -->
          <td><a style="color: black;" href="{% url 'customer_detail' customer.id %}">{{ customer.amount }}</a></td>
          <td><a style="color: black;" href="{% url 'customer_detail' customer.id %}">{{ customer.add_advance }}</a>
          </td>
          <td><a style="color: black;" href="{% url 'customer_detail' customer.id %}">{{ customer.balance_payment }}</a>
          </td>

          <td><a style="color: black;" href="{% url 'customer_detail' customer.id %}">{{ customer.activation_date }}</a></td>
          <td><a style="color: black;" href="{% url 'customer_detail' customer.id %}">{{ customer.renewal_date }}</a></td>
           <!-- <td>
        <a href="#editCustomerModal-{{customer.id}}" class="edit" data-toggle="modal"><i
                class="material-icons" data-toggle="tooltip" title="Edit">&#xE254;</i></a>
         </td>              -->
        </tr>
        {% endfor %}
      </tbody>
    </table>
    </div>
     <div class='pagination-container' id="custom-pagination"  >
      <nav>
        <ul class="pagination">
        </ul>
      </nav>
  </div>
<div class="rows_count">Showing 11 to 20 of 91 entries</div> 

</div>

  <div id="addCustomerModal" class="modal fade">
    <div class="modal-dialog">
      <div class="modal-content">
        <form action="{% url 'add' %}" method="post">
          {% csrf_token %}
          <div class="modal-header">
            <h4 class="modal-title">Add Customer</h4>
            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
          </div>
          <div class="modal-body">
            <div class="form-group">
              <label>Branch Name</label>
              <select name="branch_name" id="branch" class="form-control" aria-label="Default select example"
                aria-invalid="false">
                <option value="{{customer.branch_list}}">Select branch</option>

                {% for i in branches %}
                <option value="{{i.branch_name}}"> {{i.branch_name}}</option>
                {% endfor %}
              </select>


            </div>
            <div class="form-group">
              <label>Manager Name</label>
              <select name="manager_name" id="manageri_name" value="{{i.manager_name}}" class="form-control"
                aria-label="Default select example" aria-invalid="false">
                <option value="{{customer.manager_name}}">{{customer.manager_name}}</option>

                {% for i in rm1 %}
                <option value="{{i.manager_name}}"> {{i.manager_name}}</option>
                {% endfor %}
              </select>


            </div>
            <div class="form-group">
              <label>Executive Name</label>
              <select name="ex_name" id="ex_name" type="text" value="{{i.ex_name}}" class="form-control"
                aria-label="Default select example" aria-invalid="false">
                <option value="{{customer.ex_name}}">{{customer.ex_name}}</option>

                {% for i in executives %}
                <option value="{{i.ex_name}}"> {{i.ex_name}}</option>
                {% endfor %}
              </select>

            </div>
            

            <div class="form-group">
              <label>Company Name</label>
              <input name="company_name" type="text" class="form-control" required />

            </div>

            <div class="form-group">
              <label>Type of Client</label>
              <select name="type_of_client" onChange="changecat(this.value);" class="form-control">
                <option value="" disabled selected>Select Type of Client</option>
                <option value="New_Client">New Client</option>
                <option value="Existing_Client">Existing Client</option>
              </select>
            </div>
 
            <div class="form-group">
              <label>Status</label>
              <select name="category" id="category" class="form-control">
                <option value="" disabled selected>Select</option>
              </select>
            </div> 


<!-- 
            <div class="form-group" id="subpoints_group" >
              <label for="category">Subpoints</label>
              <select name="category" id="category" class="form-control">
                  <option value="" disabled selected>Select Subpoint</option>
              </select>
          </div> -->

 
            <div class="form-group">
              <label> Client Name</label>
              <input name="name" type="text" class="form-control" required>


            </div> 
            <div class="form-group">
              <label>Contact No</label>
              <input name="contact_detail" type="text" id="contact_detail" class="form-control"
                oninput="validateContactNumber()">
              <div id="contact_detail_message" style="display: none; color: red;">Contact number must be either 10 or 12
                digits long.</div>
            </div>



            <div class="form-group">
              <label>Mail ID</label>
              <input name="mail_id" type="text" class="form-control">
            </div>

            <div class="form-group">
              <label>Address</label>
              <input name="address" type="text" class="form-control" required />

            </div>
          
          
            <div class="form-group">
              <label for="bday">Meeting Date</label>

              <input class="form-control" type="date" name="meeting_date" pattern="[0-9]{2}-[0-9]{2}-[0-9]{4}" required>
              <span class="validity"></span>
            </div>
            <div class="form-group">
              <label for="bday">Next Meeting Date</label>
              <input class="form-control" type="date" id="dt_end_date" name="next_meeting_date"
                pattern="[0-9]{2}-[0-9]{2}-[0-9]{4}" >
              <span class="validity"></span>
            </div>

            <!-- <div class="form-group">
    <label for="bday">Next Meeting Date</label>
    <input class="form-control" type="date" id="dt_end_date" name="next_meeting_date" required>
    <span class="validity"></span>
  </div> -->

            <!--start of right half -->

            <!-- <div class="form-group">

    <label>Nature of Business</label>
    <select name="nature_of_business" type="text" class="form-control" aria-label="Default select example"
    aria-invalid="false">
    <option value="">Select Option</option>

    <option value="Manufacturer">Manufacturer</option>
    <option value="Supplier">supplier</option>
    <option value="Trader">Trader</option>
    <option value="Retail">Retail</option>

    </select>            
  </div> -->
   

            <!-- <div class="form-group">
    <label>Package Sold</label>
    <input name="package_sold" type="text" class="form-control">
  </div> -->
            <div class="form-group">
              <label>contract Value</label>
              <input name="amount" type="text" id="amount" class="form-control" oninput="validateAmount()">
              <div id="amount_message" style="display: none; color: red;">Amount must be a numeric value.</div>
            </div>          


            <div class="form-group">
              <label>Advance</label>
              <input name="add_advance" id="add_advance" type="text" class="form-control" oninput="validateAdvance()">
              <div id="advance_message" class="text-danger" style="display: none; color: red;">Enter a valid numeric
                value for the advance.</div>
            </div>

            <div class="form-group">
              <label>Balance Payment</label>
              <input name="balance_payment" id="balance_payment" type="text" class="form-control">
            </div>
            <div class="form-group">
              <label for="activation_date">Activation Date</label>
              <input class="form-control" type="date" id="activation_date" name="activation_date" placeholder="YYYY-MM-DD">
          </div>
          <div class="form-group">
              <label for="renewal_date">Renewal Date</label>
              <input class="form-control" type="date" id="renewal_date" name="renewal_date" placeholder="YYYY-MM-DD">
          </div>

          <div class="modal-footer">
            <input type="button" class="btn btn-default" data-dismiss="modal" value="Cancel">
            <input type="submit" class="btn btn-success" value="Add">
          </div>
        </form>
      </div>
    </div>
  </div>
  </div>





  <!-- Delete Customer -->
  <script>
    $(document).ready(function () {
      $('#delete_btn').click(function () {
        if (confirm('Are You Sure You Want to Delete User?')) {
          var id = [];
          var csrf = $('input[name=csrfmiddlewaretoken]').val();
          $(':checkbox:checked').each(function (i) {
            id[i] = $(this).val()
          })
          if (id.length === 0) {
            alert("please select user Which u want to delete?")
          } else {
            console.log(id)
            $.ajax({
              url: "{% url 'delete' %}",
              method: "POST",
              data: {
                id,
                csrfmiddlewaretoken: csrf
              },
              success: function (response) {
                alert("success")
                location.reload();
                for (var i = 0; i < id.length; i++) {
                  var error = $(response).find('#error_text')
                  var error_class = $(error).attr('class')
                  $('#error').addClass(error_class)
                  $('#error').text(error.text())
                  $('tr#' + id[i] + '').fadeOut('slow');
                }
              },
            })
          }
        }
      })
    })
  </script>

  <script>
    $('#select-all').click(function (event) {
      if (this.checked) {
        // Iterate each checkbox
        $(':checkbox').each(function () {
          this.checked = true;
        });
      } else {
        $(':checkbox').each(function () {
          this.checked = false;
        });
      }
    }); 
  </script>

  <script>
    function filterByDateRange(startDate, endDate) {
        let tableRows = document.querySelectorAll('#table tbody tr');

        tableRows.forEach(row => {
            let rowDate = new Date(row.cells[11].innerText); // Assuming the date is in the 12th cell

            // Set the time to the beginning and end of the day for inclusive filtering
            startDate.setHours(0, 0, 0, 0);
            endDate.setHours(23, 59, 59, 999);

            if (rowDate >= startDate && rowDate <= endDate) {
                row.style.display = 'table-row';
            } else {
                row.style.display = 'none';
            }
        });
    }

    document.getElementById('searchBtn').addEventListener('click', () => {
        let startDate = new Date(document.getElementById('min').value);
        let endDate = new Date(document.getElementById('max').value);

        if (!isNaN(startDate) && !isNaN(endDate)) {
            filterByDateRange(startDate, endDate);
        } else {
            // If one of the dates is not valid or empty, show all rows
            let tableRows = document.querySelectorAll('#table tbody tr');
            tableRows.forEach(row => {
                row.style.display = 'table-row';
            });
        }
    });
</script>
  
  <!-- Nav Bar -->
  <script>
    var menu_btn = document.querySelector("#menu-btn");
    var sidebar = document.querySelector("#sidebar");
    var container = document.querySelector(".my-container");
    menu_btn.addEventListener("click", () => {
      sidebar.classList.toggle("active-nav");
      container.classList.toggle("active-cont");
    });

  </script>

  
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
  $(function() {
    var dtToday = new Date();

    var month = dtToday.getMonth() + 1;
    var day = dtToday.getDate();
    var year = dtToday.getFullYear();
    if (month < 10)
      month = '0' + month.toString();
    if (day < 10)
      day = '0' + day.toString();

    var minDate = year + '-' + month + '-' + day;

    $('#dt_end_date').attr('min', minDate);

    // Function to update the minimum date of the Next Meeting Date field
    function updateNextMeetingDateMinDate() {
      var meetingDateValue = $('[name="meeting_date"]').val();
      if (meetingDateValue) {
        $('[name="next_meeting_date"]').attr('min', meetingDateValue);
      } else {
        $('[name="next_meeting_date"]').attr('min', minDate);
      }
    }

    // Trigger the function when the page loads and when the Meeting Date field changes
    $('[name="meeting_date"]').on('change', function() {
      updateNextMeetingDateMinDate();
    });

    // Trigger the function on page load
    updateNextMeetingDateMinDate();
  });
</script>


  <!-- Get manager and executive from branch -->
  <script>
    const branchibranch = document.getElementById('branch');
    const branchimanager_name = document.getElementById('manageri_name');
    const branchiex_name = document.getElementById('ex_name');

    branchibranch.addEventListener('change', () => {
      const selectedOption = branchibranch.options[branchibranch.selectedIndex];

      // Update the branch name field
      const branchNameElement = document.querySelector("select[name='branch_name']");
      branchNameElement.value = selectedOption.value;

      // The code below remains unchanged
      const selectedBranchID = selectedOption.value;
      fetch(`/get_all_info/${selectedBranchID}`)
        .then(response => response.json())
        .then(data => {
          console.log(data);
          branchimanager_name.value = data.manager;
          branchiex_name.value = data.executive;
        });
    });

  </script>


 

  <script>
    function validateAmount() {
      const amountInput = document.getElementById('amount');
      const amount = amountInput.value.trim();

      if (/^\d+$/.test(amount)) {
        document.getElementById('amount_message').style.display = 'none';
      } else {
        document.getElementById('amount_message').style.display = 'block';
      }
    }

  </script>


  <script>
    function validateContactNumber() {
      const contactNumberInput = document.getElementById('contact_detail');
      const contactNumber = contactNumberInput.value;

      if (contactNumber.length === 10 || contactNumber.length === 12) {
        document.getElementById('contact_detail_message').style.display = 'none';
      } else {
        document.getElementById('contact_detail_message').style.display = 'block';
      }
    }



  </script>

  <script>
    function validateAdvance() {
      const advanceInput = document.getElementById('add_advance');
      const advance = advanceInput.value.trim();

      if (/^\d+$/.test(advance)) {
        document.getElementById('advance_message').style.display = 'none';
      } else {
        document.getElementById('advance_message').style.display = 'block';
      }
    }

  </script>
    
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
    var mealsByCategory = {
        New_Client: ["Interested", "Decline", "Converted", "To be called"],
        Existing_Client: ["Same Package", "Upgraded"],
    };

    function updateSubpointsOptions() {
        var typeOfClient = $("[name='type_of_client']").val();
        var subpointsSelect = $("#category");

        subpointsSelect.empty().append("<option value='' disabled selected>Select</option>");

        if (typeOfClient) {
            var subpoints = mealsByCategory[typeOfClient];
            for (const subpoint of subpoints) {
                subpointsSelect.append("<option>" + subpoint + "</option>");
            }
        }
    }

    function updateNextMeetingDateVisibility() {
        var typeOfClient = $("[name='type_of_client']").val();
        var selectedSubpoint = $("#category").val();
        var nextMeetingDateField = $("#dt_end_date");

        if (typeOfClient === "New_Client" && selectedSubpoint === "Decline") {
            nextMeetingDateField.attr("disabled", "disabled").hide();
        } else {
            nextMeetingDateField.removeAttr("disabled").show();
        }
    }

    // Trigger the functions when the page loads and on type_of_client change
    $(document).ready(function() {
        updateSubpointsOptions();
        updateNextMeetingDateVisibility();
    });

    $("[name='type_of_client']").change(function() {
        updateSubpointsOptions();
        updateNextMeetingDateVisibility();
    });

    $("#category").change(function() {
        updateNextMeetingDateVisibility();
    });
</script>








  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"
    integrity="sha384-8Szi1jFTtfzvdsA9JOIVmtGxz8KtViN+akzQ9D24rPbHM7WxW/k0Dtzo2c6upTD5"
    crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.min.js"
    integrity="sha384-DsPecjvBQgFnhl0+5Z9nL4j1pikXVBytb4HDfAxW8rEX9XfM0gBUEaKpovf1HMJo"
    crossorigin="anonymous"></script>



<!-- Searchig data with Pagination  -->
     
<script>
  $(document).ready(function() {
    $('#table').DataTable({
      
      // Enable sorting on the 'updation_date' column
      columnDefs: [
        { targets: 'sorting-disabled', orderable: false }, // Add 'sorting-disabled' class to any column that should not be sortable
        { type: 'date', targets: 'date-sortable' } // Add 'date-sortable' class to columns containing dates for correct date sorting
      ],
      // Enable searching on the table
      searching: true,
      // Enable pagination with 10 rows per page
      paging: true,
      pageLength: 10,
      // Enable date range filtering using DataTables DateTime plugin
      dom: 'Bfrtip', // To show date range inputs, we use the 'B' (buttons) option
      buttons: [
        {
          extend: 'collection',
          text: 'Date Range',
          buttons: ['dateRange']
        }
      ],
      order: [], // You can specify default sorting here, for example: [[3, 'asc']] for the fourth column to be sorted in ascending order
    });
  });

  
</script>


<script>
$('#search').on('keyup', function() {
  var searchText = $(this).val().toLowerCase();
  
  
  $('#table tbody tr').each(function() {
    var found = false;

    $(this).find('td').each(function() {
      var cellText = $(this).text().toLowerCase();
      if (cellText.indexOf(searchText) !== -1) {
        found = true;
        return false; // Break the inner loop if a match is found in this cell
      }
    });

    $(this).toggle(found); // Show or hide the row based on the match status
  });
});


</script>





<script>
  getPagination('#table');
$('#maxRows').trigger('change');
function getPagination (table){

$('#maxRows').on('change',function(){
$('.pagination').html('');						// reset pagination div
var trnum = 0 ;									// reset tr counter 
var maxRows = parseInt($(this).val());			// get Max Rows from select option

var totalRows = $(table+' tbody tr').length;		// numbers of rows 
$(table+' tr:gt(0)').each(function(){			// each TR in  table and not the header
trnum++;									// Start Counter 
if (trnum > maxRows ){						// if tr number gt maxRows

$(this).hide();							// fade it out 
}if (trnum <= maxRows ){$(this).show();}// else fade in Important in case if it ..
});											//  was fade out to fade it in 
if (totalRows > maxRows){						// if tr total rows gt max rows option
var pagenum = Math.ceil(totalRows/maxRows);	// ceil total(rows/maxrows) to get ..  
                    //	numbers of pages 
for (var i = 1; i <= pagenum ;){			// for each page append pagination li 
$('.pagination').append('<li data-page="'+i+'">\
           <span>'+ i++ +'<span class="sr-only">(current)</span></span>\
         </li>').show();
}											// end for i 


} 												// end if row count > max rows
$('.pagination li:first-child').addClass('active'); // add active class to the first li 


//SHOWING ROWS NUMBER OUT OF TOTAL DEFAULT
showig_rows_count(maxRows, 1, totalRows);
//SHOWING ROWS NUMBER OUT OF TOTAL DEFAULT

$('.pagination li').on('click',function(e){		// on click each page
e.preventDefault();
var pageNum = $(this).attr('data-page');	// get it's number
var trIndex = 0 ;							// reset tr counter
$('.pagination li').removeClass('active');	// remove active class from all li 
$(this).addClass('active');					// add active class to the clicked 


//SHOWING ROWS NUMBER OUT OF TOTAL
showig_rows_count(maxRows, pageNum, totalRows);
//SHOWING ROWS NUMBER OUT OF TOTAL



$(table+' tr:gt(0)').each(function(){		// each tr in table not the header
trIndex++;								// tr index counter 
// if tr index gt maxRows*pageNum or lt maxRows*pageNum-maxRows fade if out
if (trIndex > (maxRows*pageNum) || trIndex <= ((maxRows*pageNum)-maxRows)){
  $(this).hide();		
}else {$(this).show();} 				//else fade in 
}); 										// end of for each tr in table
});										// end of on click pagination list
});
           // end of on select change 

     // END OF PAGINATION 

}	




// SI SETTING
$(function(){
// Just to append id number for each row  
default_index();

});

//ROWS SHOWING FUNCTION
function showig_rows_count(maxRows, pageNum, totalRows) {
//Default rows showing
var end_index = maxRows*pageNum;
var start_index = ((maxRows*pageNum)- maxRows) + parseFloat(1);
var string = 'Showing '+ start_index + ' to ' + end_index +' of ' + totalRows + ' entries';               
$('.rows_count').html(string);
}

// CREATING INDEX
function default_index() {
$('table tr:eq(0)').prepend('<th> ID </th>')

var id = 0;

$('table tr:gt(0)').each(function(){	
 id++
 $(this).prepend('<td>'+id+'</td>');
});
}

// All Table search script
function FilterkeyWord_all_table() {

// Count td if you want to search on all table instead of specific column

var count = $('.table').children('tbody').children('tr:first-child').children('td').length; 

// Declare variables
var input, filter, table, tr, td, i;
input = document.getElementById("search_input_all");
var input_value =     document.getElementById("search_input_all").value;
filter = input.value.toLowerCase();
if(input_value !=''){
table = document.getElementById("table");
tr = table.getElementsByTagName("tr");

// Loop through all table rows, and hide those who don't match the search query
for (i = 1; i < tr.length; i++) {

var flag = 0;

for(j = 0; j < count; j++){
 td = tr[i].getElementsByTagName("td")[j];
 if (td) {
  
     var td_text = td.innerHTML;  
     if (td.innerHTML.toLowerCase().indexOf(filter) > -1) {
     //var td_text = td.innerHTML;  
     //td.innerHTML = 'shaban';
       flag = 1;
     } else {
       //DO NOTHING
     }
   }
 }
if(flag==1){
          tr[i].style.display = "";
}else {
  tr[i].style.display = "none";
}
}
}else {
//RESET TABLE
$('#maxRows').trigger('change');
}
}
</script>




<script>
 // Pagination function
function updatePagination(table, maxRows, pageNum, totalRows) {
  $('.pagination').html('');
  var trnum = 0;
  var totalVisibleRows = 0; // Track the number of visible rows after filtering

  // Loop through all rows and count visible rows
  $(table + ' tbody tr').each(function () {
    trnum++;
    if ($(this).is(':visible')) {
      totalVisibleRows++;
    }

    if (trnum > maxRows * pageNum || trnum <= (maxRows * pageNum - maxRows)) {
      $(this).hide();
    } else {
      $(this).show();
    }
  });

  var pagenum = Math.ceil(totalVisibleRows / maxRows); // Use the count of visible rows
  for (var i = 1; i <= pagenum; i++) {
    $('.pagination').append('<li data-page="' + i + '">\
      <span>' + i + '<span class="sr-only">(current)</span></span>\
    </li>').show();
  }

  $('.pagination li').on('click', function (e) {
    e.preventDefault();
    var pageNum = $(this).attr('data-page');
    var trIndex = 0;
    $('.pagination li').removeClass('active');
    $(this).addClass('active');
    
    // Loop through rows and show/hide based on current page
    $(table + ' tbody tr').each(function () {
      trIndex++;
      if (trIndex > (maxRows * pageNum) || trIndex <= ((maxRows * pageNum) - maxRows)) {
        $(this).hide();
      } else {
        $(this).show();
      }
    });
  });
}


</script>


<script>
$(document).ready(function () {
  // Initialize pagination
  getPagination('#table');
  $('#maxRows').trigger('change');

  // Search input event handler
  $('#search_input_all').on('keyup', function () {
    FilterkeyWord_all_table();
  });
});

// Pagination function
function updatePagination(table, maxRows, pageNum, totalRows) {
  $('.pagination').html('');
  var trnum = 0;
  $(table + ' tbody tr:visible').each(function () {
    trnum++;
    if (trnum > maxRows * pageNum || trnum <= (maxRows * pageNum - maxRows)) {
      $(this).hide();
    } else {
      $(this).show();
    }
  });

  var pagenum = Math.ceil(totalRows / maxRows);
  for (var i = 1; i <= pagenum; i++) {
    $('.pagination').append('<li data-page="' + i + '">\
      <span>' + i + '<span class="sr-only">(current)</span></span>\
    </li>').show();
  }

  $('.pagination li').on('click', function (e) {
    e.preventDefault();
    var pageNum = $(this).attr('data-page');
    var trIndex = 0;
    $('.pagination li').removeClass('active');
    $(this).addClass('active');
    $(table + ' tbody tr:visible').each(function () {
      trIndex++;
      if (trIndex > (maxRows * pageNum) || trIndex <= ((maxRows * pageNum) - maxRows)) {
        $(this).hide();
      } else {
        $(this).show();
      }
    });
  });
}

// Search function
function FilterkeyWord_all_table() {
  var input = document.getElementById("search_input_all");
  var input_value = input.value.toLowerCase();
  var table = document.getElementById("table");
  var tr = table.getElementsByTagName("tr");
  var count = $('.table').children('tbody').children('tr:first-child').children('td').length;
  var totalRows = 0;

  for (var i = 1; i < tr.length; i++) {
    var flag = 0;
    for (var j = 0; j < count; j++) {
      var td = tr[i].getElementsByTagName("td")[j];
      if (td) {
        var td_text = td.innerHTML.toLowerCase();
        if (td_text.indexOf(input_value) > -1) {
          flag = 1;
        }
      }
    }
    if (flag == 1) {
      tr[i].style.display = "";
      totalRows++;
    } else {
      tr[i].style.display = "none";
    }
  }

  // Update pagination based on filtered results
  var maxRows = parseInt($('#maxRows').val());
  var pageNum = 1; // Reset to page 1
  updatePagination('#table', maxRows, pageNum, totalRows);
}

</script>

<script>
  $(document).ready(function() {
    var table = $('#table').DataTable({
      // Enable sorting on the 'updation_date' column
      columnDefs: [
        { targets: 'sorting-disabled', orderable: false },
        { type: 'date', targets: 'date-sortable' }
      ],
      // Enable searching on the table
      searching: true,
      // Enable pagination with 10 rows per page
      paging: true,
      pageLength: 10,
      // Enable date range filtering using DataTables DateTime plugin
      dom: 'Bfrtip', // To show date range inputs, we use the 'B' (buttons) option
      buttons: [
        {
          extend: 'collection',
          text: 'Date Range',
          buttons: ['dateRange']
        }
      ],
      order: [], // You can specify default sorting here
    });
    // Event handler for date range filter
    $('#startDate, #endDate').on('keyup change', function() {
      if ($('#startDate').val() !== '' || $('#endDate').val() !== '') {
        table.column(3).search('').draw(); // Clear any existing text search
        table.draw();
        $('.pagination').hide();
      } else {
        table.draw();
        $('.pagination').show();
      }
    });
  });
</script>




<script>
$(document).ready(function() {
  const $studentRows = $('.student-item');
  const $startDateInput = $('#startDate');
  const $endDateInput = $('#endDate');

  $startDateInput.on('input', function() {
    updateDateInputs();
  });

  $endDateInput.on('input', function() {
    updateDateInputs();
  });

  function updateDateInputs() {
    const startDate = new Date($startDateInput.val());
    const endDate = new Date($endDateInput.val());

    // Ensure proper time settings to include the entire day
    startDate.setHours(0, 0, 0, 0);
    endDate.setHours(23, 59, 59, 999);

    if (startDate > endDate) {
      // Swap the values if start date is greater than end date
      const temp = startDate;
      $startDateInput.val($endDateInput.val());
      $endDateInput.val(temp.toISOString().split('T')[0]); // Format as 'yyyy-mm-dd'

      // Update the variables
      $startDateInput.trigger('input'); // Trigger input event to update the comparison
    }

    $studentRows.hide();

    $studentRows.each(function() {
      const dateText = $(this).find('td:eq(12)').text(); // Target the 13th column (index 12)
      const rowDate = new Date(dateText);

      if (rowDate >= startDate && rowDate <= endDate) {
        $(this).show();
      }
    });
  }
});



</script>

</body>


</html>